flowchart TD
    %% High-Level System Flow (Key Features Only)
    START([Start]) --> AUTH[User Auth / Role Check]
    AUTH --> ROUTE[Search & View Routes]
    ROUTE --> BOOK[Create Booking]
    BOOK --> PAYMENT[Process Payment]
    PAYMENT -->|Success| TICKET[Generate Ticket & QR]
    PAYMENT -->|Fail| PAYMENT
    TICKET --> LIVE[Live Bus Tracking]
    LIVE --> HISTORY[Booking History / Manage]
    HISTORY --> REFUND{Refund?}
    REFUND -->|Yes| HANDLE_REFUND[Handle Refund]
    REFUND -->|No| REPORTS[Reporting & Analytics]
    HANDLE_REFUND --> REPORTS
    REPORTS --> ADMIN[Admin Management]
    ADMIN --> SETTINGS[System Settings]
    SETTINGS --> NOTIFY[Notifications]
    NOTIFY --> BACKUP[System Maintenance / Backup]
    BACKUP --> END([End])

    %% Parallel Driver & Staff Flows (Aggregated)
    AUTH --> DRIVER_PORTAL[Driver GPS / Trip Ops]
    DRIVER_PORTAL --> LIVE
    AUTH --> STAFF_PORTAL[Staff Walk-in & Support]
    STAFF_PORTAL --> BOOK

    %% Styling
    classDef core fill:#e3f2fd,stroke:#1565c0,stroke-width:2px,color:#000
    classDef decision fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef terminator fill:#e8f5e9,stroke:#2e7d32,stroke-width:3px

    class START,AUTH,ROUTE,BOOK,PAYMENT,TICKET,LIVE,HISTORY,REPORTS,ADMIN,SETTINGS,NOTIFY,BACKUP,DRIVER_PORTAL,STAFF_PORTAL core
    class REFUND decision
    class END terminator
